# 🚀 指令手册 - RMT（若梦兔）

本页介绍 **RMT（若梦兔）** 各个指令的功能与参数效果，帮助你快速掌握指令用法。

---

## 1️⃣ 间隔 (Interval)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/Interval.png)  
### 功能说明
1. **插入间隔**：用于在其他指令之间加入延时。
2. **控制宏循环**：放置在宏末尾，用于设置循环间隔时间。

### 参数解析
- **整数**：表示间隔的时长（毫秒）。
- **变量**：取变量值作为间隔时长（毫秒）。

---

## 2️⃣ 按键 (Key)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/Key.png)  

### 功能说明
- 设置按键动作：**按下、松开、点击**

### 手柄按键说明
- 使用前需安装 **vJoy**，详情查看「手柄功能指令」。

### 键盘按键检测
1. 点击输入框。
2. 按下目标按键/组合键。
3. 点击「确定」按钮，自动勾选对应按键。

### 参数解析
1. **类型**：按下 / 松开 / 点击（只有点击操作可配置以下参数）。
2. **点击时间**：按下到松开的时间。
3. **点击次数**：连续点击次数。
4. **每次间隔**：一次松开到下一次按下的间隔时间。

### 指令格式
`按键_按键名_按键类型_点击时间_点击次数_每次间隔`

---

## 3️⃣ 搜索 (Search)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/Search.png)  

### 功能说明
在屏幕上搜索 **图片、颜色或文本**，并根据搜索结果执行不同分支指令。

### 快捷键
- **F1**：开启框选范围（左键松开后关闭）。
- **F2**：取当前鼠标下颜色，并限定搜索范围为该像素点。
- **F3**：截图作为搜索图片素材。

### 搜索范围
- 指定起始坐标到终止坐标的矩形区域。

### 搜索类型
1. **图片**：在范围内匹配目标图片。
2. **颜色**：输入颜色值或用 F2 取色，在范围内查找颜色。
3. **文本**：输入文本进行匹配（支持正则表达式）。

### 鼠标动作
- **无动作**：不操作鼠标
- **移动至目标**
- **移动并点击 1 次**
- **移动并点击 2 次**

### 结果指令
- **找到目标** → 执行找到后的指令（可选）。
- **未找到目标** → 执行未找到后的指令（可选）。

---

## 4️⃣ 搜索 Pro (SearchPro)

**指令界面** 
![配置界面](/RMT/Web/Images/MacroCMD/SearchPro.png)  

### 基本参数
- **相似度**：搜索元素与素材的匹配度（值越大越严格）。
- **搜索次数**：多次尝试，直到找到或次数用尽。
- **搜索间隔**：每次搜索之间的间隔（仅当次数 > 1 时生效）。

### 鼠标动作
- **移动速度**：鼠标移动到目标的速度（100 为瞬移）。
- **点击次数**：移动后点击次数。

### 图片识别模型
1. **OpenCV 模型**（仅 64 位）：
   - 相似度 0~97：灰度识别（快，不校对颜色）。
   - 相似度 98~100：图像+颜色识别（慢）。
2. **RMT 识图**：使用 AHK 默认的 `ImageSearch` 接口（速度慢）。

### 文本识别模型
- **中文模型**：识别中/英/数字（字库大，速度慢）。
  - 字库文件：`Plugins\RapidOcr\ch_models\ppocr_keys_v1.txt`
- **英文模型**：识别英文/数字（字库小，速度快）。
  - 字库文件：`Plugins\RapidOcr\en_models\ppocr_keys_v1.txt`

> ⚠️ 如果 `ppocr_keys_v1.txt` 中缺少特定文字，请手动添加到文件顶部。

### 搜索文本
- **输入文本**：检索范围内对应文本（支持正则）。
- **变量值**：检索范围内变量的值。

### 结果保存
- **搜索成功**：保存真值到变量。
- **搜索失败**：保存假值到变量。

### 目标点保存
- **搜索成功**：保存目标点全局坐标到变量。
- **搜索失败**：不进行任何操作。

---

## 5️⃣ 移动 (Move)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/Move.png) 

### 功能说明
鼠标指针根据参数进行移动。

### 快捷键
- **F1**：将当前坐标设置成指令目标点。

### 基本参数
- **坐标位置X**：移动目标点的X轴坐标。
- **坐标位置Y**：移动目标点的Y轴坐标。
- **移动速度**：指针的移动速度（0~100，100为瞬移）。

### 相对位移
- **相对位移**：勾选时以下参数发生变化：
  - 目标点X轴坐标：指令执行时鼠标坐标X + 坐标位置X。
  - 目标点Y轴坐标：指令执行时鼠标坐标Y + 坐标位置Y。

### 指令格式
`移动_坐标X_坐标Y_移动速度_相对位移`

---

## 6️⃣ 移动 Pro (MovePro)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/MovePro.png) 

### 功能说明
鼠标指针根据参数进行移动。

### 快捷键
- **F1**：将当前坐标设置成指令目标点。

### 基本参数
- **坐标位置X**：整数/变量。
- **坐标位置Y**：整数/变量。
- **移动次数**：进行多次移动（相对位移下该参数才有效）。
- **每次间隔**：移动开始后，间隔一段时间后进行下次移动（移动次数>1该参数才有效）。

### 游戏视角
- 该选项主要用于调整游戏的镜头视角。
- 此模式下强制相对位移，移动速度100。

---

## 7️⃣ 输出 (Output)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/Output.png)  

### 功能说明
以不同的形式输出信息。

### 输出类型
1. **发送内容**：使用AHK的SendText指令发送内容。
2. **粘贴**：使用Ctrl+V组合键粘贴内容。
3. **Win粘贴**：调用Win系统接口粘贴内容。
4. **临时提示**：使用ToolTip在鼠标指针旁显示内容（默认显示5s）。
5. **指令窗口**：将内容输出到指令显示窗口。
6. **复制到剪切板**：将输出内容复制到剪切板。
7. **软件弹窗**：通过软件弹窗显示内容。
8. **系统语音**：通过语音播输出内容。

### 小技巧
文本中可用 `{变量名}` 表示对应变量值。

---

## 8️⃣ 运行 (Run)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/Run.png)  

### 功能说明
运行文件、进程或者访问网址。

### 快捷键
- **F1**：将鼠标下进程设置成路径。

### 路径
1. **网址**：执行指令时访问该网址。
2. **路径**：执行指令时运行该文件。

---

## 9️⃣ RMT指令 (RMTCMD)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/RMTCMD.png)  

### 功能说明
调用RMT（若梦兔）软件指令或者操作系统指令。

### 操作类型
1. **截图**：调用RMT软件截图指令，截图保存到 `Images\ScreenShot` 文件夹下。
2. **截图提取文本**：调用RMT软件提取文本指令，提取文本保存到剪切板中。
3. **自由贴**：调用RMT软件自由贴指令，将剪切板中的图片或文本贴在桌面上。
4. **开启指令显示**：勾选指令显示开关，窗口显示软件运行的指令。
5. **关闭指令显示**：取消勾选指令显示开关。
6. **显示菜单**：显示指定序号的菜单轮。
7. **关闭菜单**：关闭菜单轮。
8. **启用键鼠**：恢复键盘鼠标的正常输入（需要管理员身份运行软件）。
9. **禁用键鼠**：禁用键盘鼠标的输入（需要管理员身份运行软件）。
10. **休眠**：立即终止所有宏，并禁用软件的所有功能。
11. **暂停所有宏**: 立即暂停所有宏。
12. **恢复所有宏**: 恢复所有被暂停的宏。
13. **终止所有宏**：强制终止所有正在运行的宏任务，不可恢复。
14. **重载**：重新加载当前配置，撤销未保存的修改，恢复至最近一次应用状态。
15. **关闭软件**：退出关闭若梦兔软件

---

## 🔟 宏操作 (SubMacro)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/SubMacro.png)

### 功能说明
对宏进行操作。

### 基本参数
1. **宏类型**：要操作的宏类型。
2. **宏序号**：要操作的宏索引。

### 操作类型
1. **插入**：将指定宏插入当前宏指令中，配置时可以简化逻辑模块。
2. **触发**：运行指定宏，指定宏和当前宏同时执行。
3. **暂停**：暂停正在运行的指定宏（如果指定宏不在运行状态则指令无效）。
4. **取消暂停**：恢复被暂停的指定宏（如果指定宏不在暂停状态指令无效）。
5. **终止**：终止正在运行的指定宏（如果指定宏不在运行或暂停状态指令无效）。

---

## 11. 后台鼠标 (BGMouse)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/BGMouse.png) 

### 功能说明
对指定窗口进行后台鼠标操作，不影响真实键鼠操作
（需要管理员权限运行软件，部分窗口该指令无效）

### 快捷键
- **F1**：设置鼠标下窗口标题。
- **F2**：设置鼠标下窗口的鼠标窗口坐标。
- **F3**：设置鼠标标题和位置。

### 基本参数
1. **鼠标按键**：左键、中键、右键、滚轮。
2. **操作类型**：点击、双击、按下、松开。
3. **窗口坐标**：后台鼠标操作时的窗口位置。
4. **滚动数值**：滚轮滚动的数值。
---

## 12. 后台按键 (BGKey)

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/BGKey.png)

### 功能说明
对指定窗口进行后台按键操作。不影响真实键鼠操作
（需要管理员权限运行软件，部分窗口该指令无效）

### 窗口信息
指令绑定的窗口信息
---

## 13. 变量

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/Variable.png)

### 功能说明
创建、复制、删除变量


### 操作类型
1. **数值**：对变量进行赋值
2. **随机数值**：在最小值和最大值之间随机生成一个数值对变量赋值
3. **字符**：使用字符对变量赋值
4. **删除**：删除变量，如果变量不存在指令无效

### 指令选项
1. **全局变量**：勾选则对全局变量进行操作，否则局部变量
2. **变量存在忽略**：如果变量存在忽略对变量的操作

---

## 14. 变量提取

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/ExVariable.png)
### 功能说明
提取数值或者文本保存到变量中

### 快捷键
- **F1**：左键框选搜索范围

### 识别模型
- **中文模型**：识别中/英/数字（字库大，速度慢）。
  - 字库文件：`Plugins\RapidOcr\ch_models\ppocr_keys_v1.txt`
- **英文模型**：识别英文/数字（字库小，速度快）。
  - 字库文件：`Plugins\RapidOcr\en_models\ppocr_keys_v1.txt`

> ⚠️ 如果 `ppocr_keys_v1.txt` 中缺少特定文字，请手动添加到文件顶部。

### 基本参数
- **提取源**：屏幕/剪切板
- **搜索范围**：文本提取的屏幕范围
- **搜索次数**：多次尝试，直到找到或次数用尽。
- **搜索间隔**：每次搜索之间的间隔（仅当次数 > 1 时生效）。

### 提取文本
- 使用&x代替数字变量位置，使用&c代替文本变量位置
- 形如：`"&x"`从识别的的文本中提取第一个数值到变量1中
- 形如：`"&c"`从识别的的文本中提取第一段文本到变量1中
- 形如：`"HP：&x"`可以从`"HP：3,000`"文本提取中的3000到变量1
- 形如：`"坐标(&x,&x)"`可以从`"坐标(10.5,8.6)`"文本提取中的10.5和8.6到变量1和变量2

### 指令选项
1. **全局变量**：勾选则对全局变量进行操作，否则局部变量
2. **变量存在忽略**：如果变量存在忽略对变量的操作

### 注意事项
- 1.变量提取不是100%成功
- 2.如果“数值”变量不存在，并且提取失败，那么会创建“数值“变量，值为0
- 3.如果“数值”变量存在，并且提取失败，那么不会对变量进行任何操作
- 4.如果“数值”变量存在，并且提取成功，那么会创建“数值“变量，值为提取的值
- 5.如果“数值”变量不存在，并且提取成功，那么会创建“数值“变量，值为提取的值

---

## 15. 变量运算

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/Operation.png)

### 功能说明
通过运算表达式获得新数值保存到变量中

### 指令选项
1. **全局变量**：勾选则对全局变量进行操作，否则局部变量
2. **变量存在忽略**：如果变量存在忽略对变量的操作

---

## 16.如果

**指令界面**  
![配置界面](/RMT/Web/Images/MacroCMD/If.png)

### 功能说明
根据逻辑结果执行不同的操作

### 判断类型
1. **大于**：左边数值大于右边数值
2. **大于等于**：左边数值大于等于右边数值
3. **等于**：左边数值等于右边数值
4. **小于等于**：左边数值小于等于右边数值
5. **小于**：左边数值小于右边数值
6. **字符包含**：左边的字符包含右边的字符
7. **变量存在**：左边变量存在

### 逻辑关系
1. **且**： 所有判断都真，结果真，否者结果假
2. **或**： 只要有一个判断真，结果真，否则结果假

### 指令选项
1. **全局变量**：勾选则对全局变量进行操作，否则局部变量
2. **变量存在忽略**：如果变量存在忽略对变量的操作

### 小贴士
- 判断优先使用局部变量

---